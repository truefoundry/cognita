# Base image
FROM node:22 AS development-stage

# Define build arguments
ARG VITE_DOCS_QA_DELETE_COLLECTIONS
ARG VITE_DOCS_QA_ENABLE_REDIRECT
ARG VITE_DOCS_QA_MAX_UPLOAD_SIZE_MB
ARG VITE_DOCS_QA_STANDALONE_PATH
ARG VITE_GTAG_ID
ARG VITE_QA_FOUNDRY_URL
ARG VITE_USE_LOCAL
ARG VITE_USE_RELATIVE_BASE_URL

# Set environment variables from build arguments
ENV VITE_DOCS_QA_DELETE_COLLECTIONS=${VITE_DOCS_QA_DELETE_COLLECTIONS} \
  VITE_DOCS_QA_ENABLE_REDIRECT=${VITE_DOCS_QA_ENABLE_REDIRECT} \
  VITE_DOCS_QA_MAX_UPLOAD_SIZE_MB=${VITE_DOCS_QA_MAX_UPLOAD_SIZE_MB} \
  VITE_DOCS_QA_STANDALONE_PATH=${VITE_DOCS_QA_STANDALONE_PATH} \
  VITE_GTAG_ID=${VITE_GTAG_ID} \
  VITE_QA_FOUNDRY_URL=${VITE_QA_FOUNDRY_URL} \
  VITE_USE_LOCAL=${VITE_USE_LOCAL} \
  VITE_USE_RELATIVE_BASE_URL=${VITE_USE_RELATIVE_BASE_URL}

# Set working directory
WORKDIR /app

# Copy package.json and yarn.lock files
COPY package.json yarn.lock ./

# Install dependencies
RUN yarn install --frozen-lockfile

# Copy the rest of your application code
COPY . .

# Expose port 5001 for the development server
EXPOSE 5001
